### GraphQL Endpoint Testing
@baseUrl = http://localhost:3000
@graphqlUrl = {{baseUrl}}/graphql
@token = YOUR_JWT_TOKEN_HERE

### ============================================
### AUTHENTICATION MUTATIONS
### ============================================

### 1. Register User
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "mutation Register($input: RegisterInput!) { register(input: $input) { token user { id username email createdAt } } }",
  "variables": {
    "input": {
      "username": "graphqluser",
      "email": "graphql@example.com",
      "password": "password123"
    }
  }
}

### 2. Login User
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "mutation Login($input: LoginInput!) { login(input: $input) { token user { id username email } } }",
  "variables": {
    "input": {
      "email": "graphql@example.com",
      "password": "password123"
    }
  }
}

### 3. Get Current User (Protected)
POST {{graphqlUrl}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "query": "query { me { id username email createdAt updatedAt } }"
}

### ============================================
### PUBLIC PROBLEM QUERIES
### ============================================

### 4. Get Paginated Problems
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query GetProblems($page: Int, $limit: Int) { problems(page: $page, limit: $limit) { data { id title titleSlug difficulty topics likes dislikes acceptanceRate } pagination { page limit total totalPages } } }",
  "variables": {
    "page": 1,
    "limit": 20
  }
}

### 5. Get Problems with Filters
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query GetProblemsFiltered($page: Int, $limit: Int, $filters: ProblemFilters) { problems(page: $page, limit: $limit, filters: $filters) { data { id title difficulty topics } pagination { total totalPages } } }",
  "variables": {
    "page": 1,
    "limit": 10,
    "filters": {
      "difficulty": "Easy",
      "topic": "Array"
    }
  }
}

### 6. Get Single Problem by ID
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query GetProblem($id: Int!) { problem(id: $id) { id title titleSlug difficulty description hints topics solutionCodePython likes dislikes acceptanceRate createdAt } }",
  "variables": {
    "id": 1
  }
}

### 7. Get Problem by Slug
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query GetProblemBySlug($slug: String!) { problemBySlug(slug: $slug) { id title difficulty description topics hints } }",
  "variables": {
    "slug": "two-sum"
  }
}

### 8. Search Problems
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query SearchProblems($query: String!) { searchProblems(query: $query) { id title difficulty topics } }",
  "variables": {
    "query": "tree"
  }
}

### 9. Get Problems by Difficulty
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query GetByDifficulty($difficulty: Difficulty!) { problemsByDifficulty(difficulty: $difficulty) { id title acceptanceRate likes } }",
  "variables": {
    "difficulty": "Hard"
  }
}

### 10. Get Problems by Topic
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query GetByTopic($topic: String!) { problemsByTopic(topic: $topic) { id title difficulty } }",
  "variables": {
    "topic": "Dynamic Programming"
  }
}

### 11. Get Statistics
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query { problemStatistics { total byDifficulty { easy medium hard } totalTopics topics } }"
}

### ============================================
### PROTECTED MUTATIONS (Require Auth)
### ============================================

### 12. Create Problem (Protected)
POST {{graphqlUrl}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "query": "mutation CreateProblem($input: CreateProblemInput!) { createProblem(input: $input) { id title titleSlug difficulty topics createdAt } }",
  "variables": {
    "input": {
      "title": "GraphQL Test Problem",
      "titleSlug": "graphql-test-problem",
      "difficulty": "Medium",
      "description": "This is a test problem created via GraphQL",
      "topics": ["Array", "Hash Table"],
      "hints": ["Use a hash map"]
    }
  }
}

### 13. Update Problem (Protected)
POST {{graphqlUrl}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "query": "mutation UpdateProblem($id: Int!, $input: UpdateProblemInput!) { updateProblem(id: $id, input: $input) { id title difficulty topics updatedAt } }",
  "variables": {
    "id": 1,
    "input": {
      "title": "Updated Title via GraphQL",
      "difficulty": "Hard",
      "topics": ["Array", "Hash Table", "Two Pointers"]
    }
  }
}

### 14. Delete Problem (Protected)
POST {{graphqlUrl}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "query": "mutation DeleteProblem($id: Int!) { deleteProblem(id: $id) }",
  "variables": {
    "id": 1
  }
}

### ============================================
### COMBINED QUERIES
### ============================================

### 15. Get Multiple Data Points
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query { stats: problemStatistics { total byDifficulty { easy medium hard } } easyProblems: problemsByDifficulty(difficulty: Easy) { id title } recentProblems: problems(page: 1, limit: 5) { data { id title createdAt } } }"
}

### 16. Get User + Problems
POST {{graphqlUrl}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "query": "query { me { id username email } problems(page: 1, limit: 5) { data { id title difficulty } } }"
}

### ============================================
### ERROR HANDLING TESTS
### ============================================

### 17. Unauthenticated Mutation (Should Fail)
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "mutation { createProblem(input: { title: \"Test\", titleSlug: \"test\", difficulty: Easy }) { id } }"
}

### 18. Invalid Input (Should Fail)
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "mutation Register($input: RegisterInput!) { register(input: $input) { token } }",
  "variables": {
    "input": {
      "username": "ab",
      "email": "invalid-email",
      "password": "123"
    }
  }
}

### 19. Problem Not Found (Should Fail)
POST {{graphqlUrl}}
Content-Type: application/json

{
  "query": "query { problem(id: 999999) { id title } }"
}